# Этапы создания приложения: Монолитная и Микросервисная архитектура

| Этапы создания приложения | Роль разработчика (Монолит) | Роль разработчика (Микросервисы) | Роль безопасника (Монолит) | Роль безопасника (Микросервисы) | Роль администратора (Монолит) | Роль администратора (Микросервисы) | Роль DevOps (Монолит) | Роль DevOps (Микросервисы) | Роль QA (Монолит) | Роль QA (Микросервисы) | Все остальные |
|-|-|-|-|-|-|-|-|-|-|-|-|
| **1. Сбор требований** | Анализ требований, проектирование | Анализ требований для каждого сервиса | Определение требований безопасности | Определение требований безопасности для каждого сервиса | Участие в обсуждении требований | Участие в обсуждении требований | Координация с командой | Координация с командой | Участие в сборах требований | Участие в сборах требований | Участие в обсуждении |
| **2. Проектирование архитектуры** | Разработка единой архитектуры | Разработка архитектуры микросервисов | Учет аспектов безопасности | Учет безопасности для взаимодействия сервисов | Оценка инфраструктуры | Оценка инфраструктуры для сервисов | Выбор инструментов CI/CD | Выбор инструментов CI/CD для микросервисов | Участие в проектировании тестов | Участие в проектировании тестов | Обсуждение архитектуры |
| **3. Разработка** | Написание кода | Написание кода для каждого сервиса | Кодирование безопасных функций | Кодирование безопасных функций для каждого сервиса | Настройка серверов | Настройка серверов для каждого сервиса | Настройка окружения | Настройка окружения и контейнеров | Написание тестов | Написание тестов для каждого сервиса | Предоставление обратной связи |
| **4. Тестирование** | Участие в интеграционном тестировании | Проведение тестов для каждого сервиса | Проведение тестов безопасности | Проведение тестов безопасности для каждого сервиса | Участие в тестировании | Участие в тестировании сервисов | Поддержка тестового окружения | Поддержка тестового окружения | Выполнение тестов | Выполнение тестов для каждого сервиса | Участие в тестировании |
| **5. Развертывание** | Развертывание единого приложения | Развертывание каждого сервиса | Проверка на безопасность | Проверка безопасности для каждого сервиса | Настройка серверов | Настройка серверов для каждого сервиса | Автоматизация развертывания | Автоматизация развертывания для сервисов | Проверка работоспособности | Проверка работоспособности для каждого сервиса | Участие в развертывании |
| **6. Мониторинг и поддержка** | Устранение ошибок | Устранение ошибок в каждом сервисе | Проверка безопасности в процессе | Проверка безопасности в каждом сервисе | Поддержка инфраструктуры | Поддержка инфраструктуры для сервисов | Настройка мониторинга и логирования | Настройка мониторинга для каждого сервиса | Регулярное тестирование | Регулярное тестирование для сервисов | Обратная связь по работе системы |
| **7. Обновление и улучшение** | Разработка новых функций | Разработка новых функций для каждого сервиса | Анализ и внедрение новых мер безопасности | Анализ и внедрение мер безопасности для каждого сервиса | Оценка ресурсов | Оценка ресурсов для сервисов | Обновление инфраструктуры | Обновление инфраструктуры для сервисов | Регресс-тестирование | Регресс-тестирование для сервисов | Участие в обсуждении улучшений |

# Сравнение микросервисов и монолита

| Параметры | Монолитная архитектура | Микросервисная архитектура |
|-|-|-|
| **Определение** | Единое приложение с одной кодовой базой | Составлено из множества независимых сервисов |
| **Кодовая база** | Единая кодовая база | Каждый сервис имеет свою кодовую базу |
| **Развертывание** | Одноразовое развертывание всего приложения | Независимое развертывание каждого сервиса |
| **Тестирование** | Проще проводить интеграционные тесты | Сложнее, необходимо учитывать взаимодействие |
| **Производительность** | Высокая, без сетевых задержек | Могут быть сетевые задержки |
| **Масштабирование** | Масштабирование всего приложения | Масштабирование отдельных сервисов |
| **Поддержка** | Сложная при увеличении кода | Упрощенная благодаря декомпозиции |
| **Риски при развертывании**| Изменения в одном компоненте влияют на всё | Изменения в одном сервисе не влияют на другие |
| **Технологическое разнообразие** | Ограничено одной технологией | Разные технологии для разных микросервисов |
| **Управление** | Проще управлять | Сложнее, требуется мониторинг множества сервисов |

# Основные компоненты микросервисной и монолитной архитектуры

| Технология | Средства | Компоненты | Применение в монолитной архитектуре | Применение в микросервисной архитектуре | Применение при взаимодействии и использование программистами и DevOps |
|-|-|-|-|-|-|
| Брокер сообщений | RabbitMQ, Kafka | Продюсеры, Консьюмеры, Очереди | Обеспечивает асинхронное взаимодействие между компонентами монолита через очереди сообщений. | Обеспечивает взаимодействие между микросервисами, позволяя им обмениваться сообщениями и событиями через очереди. | Используется для обеспечения надежной и масштабируемой передачи сообщений между сервисами. |
| СУБД | PostgreSQL, MySQL | Таблицы, Индексы, Триггеры | Центральное хранилище данных для всех компонентов монолита, используется для хранения и запросов данных. | Каждому микросервису может быть назначена своя база данных, что позволяет изолировать данные и улучшить масштабируемость. | Хранение данных, выполнение транзакций, обеспечение целостности и согласованности данных. |
| Контейнеры | Docker | Образы, Контейнеры, Dockerfile | Могут использоваться для изоляции приложения в монолитной архитектуре, но чаще применяются для разработки и тестирования. | Основной способ упаковки и развертывания микросервисов, обеспечивая изоляцию и независимость среды выполнения. | Обеспечивают изоляцию среды выполнения, упрощают деплоймент и масштабирование приложений. |
| Оркестратор контейнеров | Kubernetes | Поды, Сервисы, Ingress | Обычно не используется в чисто монолитной архитектуре, за исключением случаев контейнеризации. | Управляет развертыванием, масштабированием и работоспособностью контейнеризированных микросервисов. | Автоматизирует управление контейнерами, балансировку нагрузки и восстановление после сбоев. |
| API-шлюз | Kong, Zuul | Роуты, Плагины, Сервисы | Может применяться для маршрутизации запросов к различным частям монолита и обеспечения единой точки входа. | Обеспечивает маршрутизацию и управление запросами между клиентами и микросервисами, предоставляет функции аутентификации, авторизации и мониторинга. | Центральная точка управления и маршрутизации API-запросов. |
| Система логгирования | ELK Stack (Elasticsearch, Logstash, Kibana) | Индексы, Логи, Дашборды | Централизованное логгирование событий и ошибок для анализа и мониторинга работы монолитного приложения. | Централизованное логгирование событий и ошибок из множества микросервисов для анализа и мониторинга. | Помогает в анализе и мониторинге работы приложений, выявлении и устранении ошибок. |
| Сервис обнаружения | Consul, Eureka | Регистры, Инстансы, Сервисы | Обычно не используется, так как все компоненты монолита уже известны и связаны между собой. | Автоматически обнаруживает и отслеживает микросервисы, обеспечивая их взаимодействие и маршрутизацию. | Автоматизирует процесс обнаружения и взаимодействия между микросервисами. |
| CI/CD | Jenkins, GitLab CI | Пайплайны, Агент, Триггеры | Автоматизация сборки, тестирования и развертывания монолитных приложений. | Автоматизация сборки, тестирования и развертывания микросервисов, позволяя быстро и надежно выпускать новые версии. | Обеспечивает непрерывную интеграцию и доставку изменений в коде приложения. |
| Балансировщик нагрузки | Nginx, HAProxy | Балансировщики, Серверы, Конфигурации | Распределяет входящий трафик между несколькими экземплярами монолитного приложения для обеспечения высокой доступности и производительности. | Распределяет трафик между множеством микросервисов, обеспечивая высокую доступность и отказоустойчивость. | Обеспечивает равномерное распределение нагрузки и повышение отказоустойчивости приложений. |
| Система мониторинга | Prometheus, Grafana | Метрики, Аллерты, Дашборды | Мониторинг состояния и производительности монолитного приложения, сбор метрик и создание дашбордов для анализа. | Мониторинг состояния и производительности каждого микросервиса, сбор метрик и создание дашбордов для анализа. | Обеспечивает видимость и контроль за состоянием и производительностью приложений. |
| Конфигурационный сервер | Spring Cloud Config, Consul | Стораджи, Конфигурации, Версии | Хранение и управление конфигурациями монолитного приложения, обеспечивая централизованное управление настройками. | Управление конфигурациями множества микросервисов, позволяя централизованно управлять настройками и версиями конфигураций. | Централизованное управление конфигурациями, что упрощает управление настройками приложений. |
| Сервис трассировки | Jaeger, Zipkin | Трейсы, Спаны, Репортеры | Отслеживание выполнения запросов внутри монолитного приложения для анализа производительности и выявления узких мест. | Отслеживание выполнения запросов через множество микросервисов, обеспечивая полную видимость цепочки запросов и выявление узких мест. | Помогает в диагностике и оптимизации производительности приложений. |
| Кэширование | Redis, Memcached | Кэши, Ключи, Значения | Ускорение доступа к часто используемым данным в монолитном приложении, уменьшая нагрузку на базу данных. | Ускорение доступа к часто используемым данным в микросервисах, уменьшая задержки и нагрузку на базы данных. | Повышает производительность приложений за счет уменьшения времени доступа к данным. |
| Система тестирования | JUnit, Selenium | Тесты, Скрипты, Отчеты | Автоматизация тестирования монолитного приложения, проверка функциональности и производительности. | Автоматизация тестирования каждого микросервиса, проверка функциональности, производительности и взаимодействия между сервисами. | Обеспечивает качество и надежность кода путем автоматизации тестирования. |
| Система управления версиями | Git, SVN | Репозитории, Коммиты, Ветви | Управление исходным кодом монолитного приложения, позволяя отслеживать изменения и управлять версиями. | Управление исходным кодом каждого микросервиса, позволяя отслеживать изменения и управлять версиями. | Обеспечивает контроль версий и совместную работу над исходным кодом. |
| Сервис аутентификации | OAuth, OpenID Connect | Токены, Провайдеры, Клиенты | Обеспечивает единый механизм аутентификации для всего монолитного приложения. | Обеспечивает единый механизм аутентификации для всех микросервисов, позволяя централизованно управлять доступом. | Повышает безопасность приложений за счет централизованного управления аутентификацией. |
| Система управления конфигурацией | Ansible, Chef | Плейбуки, Рецепты, Ноды | Автоматизация конфигурации и управления инфраструктурой для развертывания монолитного приложения. | Автоматизация конфигурации и управления инфраструктурой для развертывания микросервисов. | Обеспечивает автоматизацию управления конфигурациями и развертывания инфраструктуры. |


