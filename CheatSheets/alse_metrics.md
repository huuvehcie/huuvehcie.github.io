| № | Объект замера | Замеряемое значение | Команда | Метрики | Примечание |
|---|---|---|---|---|---|
| 1 | Нагрузка на CPU | Средняя загрузка процессора за последние часы/дни | `sar -u` | `%user`, `%system`, `%iowait`, `%steal`, `%idle` | Отображает распределение времени CPU между пользовательскими процессами, системными вызовами, ожиданием I/O и простой. Используется для анализа общей нагрузки на процессор. |
| 2 | Нагрузка на CPU | Процессы с наибольшей нагрузкой | `pidstat -u` | `%CPU` | Не относится напрямую к `sar`, но входит в пакет sysstat. Позволяет увидеть конкретные процессы, потребляющие ресурсы CPU. |
| 3 | Нагрузка на CPU | Моменты высокой нагрузки | `sar -u -f /var/log/sysstat/saXX` | `%user`, `%system`, `%idle` | Анализ исторических данных позволяет выявить пики нагрузки. Низкий `%idle` говорит о перегрузке CPU. |
| 4 | Нагрузка на CPU | Распределение нагрузки между user/system/iowait/idle | `sar -u` | `%user`, `%system`, `%iowait`, `%steal`, `%idle` | Каждая метрика показывает процент времени CPU, потраченного на определенный тип активности. Полезно при диагностике источников нагрузки. |
| 5 | Использование памяти | Изменение использования RAM за день | `sar -r` | `%memused`, `kbmemfree`, `kbcached` | Отслеживает объем занятой и свободной оперативной памяти, а также кэшированных данных. |
| 6 | Использование памяти | Нехватка свободной памяти | `sar -r` | `%memused`, `kbmemfree` | Если `%memused` > 90% или `kbmemfree` близко к нулю — система испытывает дефицит памяти. |
| 7 | Использование подкачки | Нагрузка на раздел swap | `sar -S` | `%swpused`, `kbswpused` | Высокий уровень использования подкачки может свидетельствовать о недостатке физической памяти. |
| 8 | Сетевой трафик | Объем данных через сетевые интерфейсы | `sar -n DEV` | `rxkB/s`, `txkB/s` | Показывает скорость приема и передачи данных по каждому сетевому интерфейсу. |
| 9 | Сетевой трафик | Пики сетевой активности | `sar -n DEV` | `rxkB/s`, `txkB/s` | Анализ графиков позволяет выявить временные интервалы с повышенной сетевой нагрузкой. |
| 10| Сетевой трафик | Наиболее нагруженный интерфейс | `sar -n DEV` | `IFACE`, `rxkB/s`, `txkB/s` | Сравнение значений по всем интерфейсам позволяет определить наиболее активный сетевой адаптер. |
| 11| Производительность системы | Общая динамика производительности за период | `sar -A -f /var/log/sysstat/saXX` | Все доступные метрики (`-u`, `-r`, `-b`, `-n`, etc.) | Команда выводит полную статистику по всем компонентам системы за указанный день. Подходит для комплексного анализа. |
| 12| Производительность системы | Ресурсы, работающие на пределе | `sar -u`, `sar -r`, `sar -b`, `sar -n DEV` | `%idle`, `%memused`, `tps`, `rxkB/s`, `txkB/s` | Для каждого ресурса: низкий `%idle` = перегрузка CPU; высокий `%memused` = нехватка памяти; высокий `tps` = перегрузка диска; высокие `rx/tx` = сетевое ограничение. |
| 13| Производительность системы | Моменты нехватки ресурсов | `sar -u`, `sar -r`, `sar -n DEV` | `%idle`, `%memused`, `rxkB/s`, `txkB/s` | Сравнение значений с порогами (%idle < 10%, %memused > 90%) позволяет выявить моменты нехватки ресурсов. |
| 14| Дисковый I/O | Статистика операций чтения/записи | `sar -b` | `tps`, `rtps`, `wtps`, `bread/s`, `bwrtn/s` | Позволяет отследить интенсивность работы с диском. Высокое значение `tps` может говорить о дисковом бутылочном горле. |
| 15| Дисковый I/O | Статистика по отдельным дискам | `sar -d` | `tps`, `rkB/s`, `wkB/s`, `await`, `%util` | Позволяет понять, какие диски работают на пределе (например, `%util ~100%`). |
| 16| Контекстные переключения | Частота переключений задач | `sar -w` | `proc/s`, `cswch/s` | Высокое значение `cswch/s` может указывать на частые переключения потоков. |
| 17| Подкачка | Интенсивность подкачки | `sar -W` | `pswpin/s`, `pswpout/s` | Высокие значения могут говорить о нехватке оперативной памяти. |
| 18| Docker | Загрузка контейнеров | `docker stats` | CPU %, Mem Usage, Net I/O, Block I/O | Отслеживает использование ресурсов отдельными контейнерами. |
| 19| Docker | Использование ресурсов контейнерами | `docker stats --no-stream` | CPU %, Mem Usage, Net I/O, Block I/O | Показывает текущее состояние контейнеров без постоянного потока. |
| 20| Kubernetes | Нагрузка на ноды | `kubectl top node` | CPU(cores), CPU%, MEM(bytes), MEM% | Позволяет понять, какие ноды перегружены. |
| 21| Kubernetes | Использование ресурсов подами | `kubectl top pod` | CPU(cores), MEM(bytes) | Показывает, какие поды используют больше всего ресурсов. |
| 22| Kubernetes | Использование диска | `sar -b` + `sar -d` | `tps`, `bread/s`, `bwrtn/s`, `await` | В комбинации с `kubectl logs` можно диагностировать активность подов, связанных с диском. |
| 23| Kubernetes | Сетевая активность | `sar -n DEV` | `rxkB/s`, `txkB/s` | Позволяет выявить ноды или поды с высокой сетевой нагрузкой. |
| 24| Системная очередь | Состояние очереди процессов | `sar -q` | `runq-sz`, `ldavg-1`, `ldavg-5`, `ldavg-15` | Высокое значение `runq-sz` может указывать на перегрузку CPU или проблемы с I/O. |
| 25| Файловые дескрипторы | Использование дескрипторов файлов | `sar -v` | `file-nr`, `dentunusd` | Высокие значения `file-nr` могут указывать на утечку дескрипторов или чрезмерное их использование. |
| 26| Страницы памяти | Статистика страничных ошибок | `sar -B` | `pgpgin/s`, `pgpgout/s`, `fault/s`, `majflt/s` | Высокие значения `majflt/s` могут говорить о нехватке RAM или плохом управлении памятью. |
| 27| Страницы памяти | Использование Swap | `sar -S` | `%swpused`, `kbswpused` | Высокое значение `%swpused` может быть следствием нехватки RAM. |
| 28| Docker/Kubernetes | Логирование с временными метками | `journalctl -u docker.service \| grep -i error` | Временная метка, событие | Используется для анализа проблемных моментов в работе контейнеров и подов. |
| 29| Docker/Kubernetes | Автоматический сбор метрик с временными метками | `node exporter + Prometheus` + `sar -A -f /var/log/sysstat/saXX` | CPU, Memory, Disk I/O, Network, Pod metrics | Для автоматического мониторинга с привязкой ко времени используется интеграция SAR с Prometheus/Grafana или kSar. |
| 30| Docker/Kubernetes | Долгосрочный мониторинг с сохранением истории | `cron` + `sar -o /var/log/sysstat/sa$(date +%d)` 60 10` | Все доступные метрики | Позволяет хранить данные по контейнерам и нодам в историческом разрезе с привязкой ко времени. |
