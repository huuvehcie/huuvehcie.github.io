| Ключ Zapret | Ключ Buydpi | Описание (из предоставленных инструкций) |
| :--- | :--- | :--- |
| **Конфигурация и Общие Параметры** | | |
| `@<config_file>` или `$<config_file>` | | `zapret`: читать конфигурацию из файла. опция должна быть первой. остальные опции игнорируются. |
| `--debug=0|1` | | `zapret`: 1=выводить отладочные сообщения |
| `--dry-run` | | `zapret`: проверить опции командной строки и выйти. код 0 - успешная проверка. |
| `--version` | | `zapret`: вывести версию и выйти |
| | `-i, --ip <ip>` | `buydpi`: Прослушиваемый IP, по умолчанию 0.0.0.0 |
| | `-p, --port <num>` | `buydpi`: Прослушиваемый порт, по умолчанию 1080 |
| | `-c, --max-conn <count>` | `buydpi`: Максимальное количество клиентских подключений, по умолчанию 512 |
| | `-b, --buf-size <size>` | `buydpi`: Максимальный размер данных, получаемых и отправляемых за один вызов recv/send. Размер указывается в байтах, по умолчанию равен 16384 |
| `--daemon` | | `zapret`: демонизировать прогу |
| `--pidfile=<file>` | | `zapret`: сохранить PID в файл |
| `--user=<username>` или `--uid=uid[:gid]` | | `zapret`: менять uid процесса |
| **Сетевые Настройки и Привязка** | | |
| `--qnum=N` | | `zapret`: номер очереди N (специфично для NFQUEUE) |
| `--bind-fix4` / `--bind-fix6` | | `zapret`: пытаться решить проблему неверного выбора исходящего интерфейса для сгенерированных ipv4/ipv6 пакетов |
| | `-I, --conn-ip <ip>` | `buydpi`: Адрес, к которому будут привязаны исходящие соединения, по умолчанию ::. При указании IPv4 адреса запросы на IPv6 будут отклоняться |
| `--ctrack-timeouts=S:E:F[:U]` | | `zapret`: таймауты внутреннего conntrack в состояниях SYN, ESTABLISHED, FIN, таймаут udp. |
| `--ctrack-disable=[0|1]` | | `zapret`: 1 или остутствие аргумента отключает conntrack |
| | `-F, --tfo` | `buydpi`: Включает TCP Fast Open. Если сервер его поддерживает, то первый пакет будет отправлен сразу вместе с SYN. Поддерживается только в Linux (4.11+) |
| **Модификация TTL** | | |
| `--orig-ttl=<int>` / `--orig-ttl6=<int>` | `-g, --def-ttl <num>` | `zapret`: модифицировать TTL оригинального пакета. `buydpi`: Значение TTL для всех исходящий соединений. Может быть полезен для обхода обнаружения нестандартного/уменьшенного TTL. |
| `--orig-autottl` / `--orig-autottl6` | | `zapret`: режим auto ttl для ipv4 и ipv6 (для оригинальных пакетов). |
| `--dpi-desync-ttl=<int>` / `--dpi-desync-ttl6=<int>` | `-t, --ttl <num>` | `zapret`: установить ttl для десинхронизирующих пакетов. `buydpi`: TTL для поддельного пакета, по умолчанию 8. Необходимо подобрать такое значение, чтобы пакет не дошел до сервера, но был обработан DPI. |
| `--dpi-desync-autottl` / `--dpi-desync-autottl6` | | `zapret`: режим auto ttl для ipv4 и ipv6 (для десинхронизирующих пакетов). |
| **Кэширование** | | |
| `--ipcache-lifetime=<int>` | `-u, --cache-ttl <sec>` | `zapret`: время жизни записей кэша IP в секундах. `buydpi`: Время жизни значения в кеше, по умолчанию 100800 (28 часов). |
| `--ipcache-hostname=[0|1]` | | `zapret`: 1 или отсутствие аргумента включают кэширование имен хостов для применения в стратегиях нулевой фазы |
| **Модификация HTTP Заголовков (Host)** | | |
| `--hostcase` | `-M, --mod-http` (с опцией `hcsmix`) | `zapret`: менять регистр заголовка "Host:" по умолчанию на "host:". `buydpi` (при `hcsmix`): "Host: name" -> "hOsT: name" |
| `--hostnospace` | `-M, --mod-http` (с опцией `rmspace`) | `zapret`: убрать пробел после "Host:" и переместить его в конец значения "User-Agent:". `buydpi` (при `rmspace`): "Host: name" -> "Host:name\t" |
| `--hostspell=HoST` | | `zapret`: точное написание заголовка Host (можно "HOST" или "HoSt"). |
| `--domcase` | `-M, --mod-http` (с опцией `dcsmix`) | `zapret`: домен после Host: сделать таким : TeSt.cOm. `buydpi` (при `dcsmix`): "Host: name" -> "Host: NaMe" |
| `--methodeol` | | `zapret`: добавить перевод строки в unix стиле ('\n') перед методом и убрать пробел из Host. |
| **Техники Десинхронизации DPI (Общее)** | | |
| `--dpi-desync=[<mode0>,]<mode>[,<mode2]` (где mode: synack, syndata, fake, rst, hopbyhop, ipfrag1 и др.) | | `zapret`: атака по десинхронизации DPI (множество режимов). |
| | `-s, --split <n[+s]>` | `buydpi`: Разбить запрос по указанному смещению. После числа можно добавить флаг: +s: добавить смещение SNI, +h: добавить смещение Host. Можно указывать несколько раз. |
| | `-d, --disorder <n[+s]>` | `buydpi`: Подобен --split, но части отправляются в обратном порядке. |
| | `-o, --oob <n[+s]>` | `buydpi`: Подобен --split, но часть отсылается как OOB данные. |
| | `-q, --disoob <n[+s]>` | `buydpi`: Подобен --disorder, но часть отсылается как OOB данные. |
| | `-f, --fake <n[+s]>` | `buydpi`: Подобен --disorder, только перед отправкой первого куска отправляется часть поддельного. Количество байт отправляемого из фейка равно рамеру разбиваемой части. |
| | `-r, --tlsrec <n[+s]>` | `buydpi`: Разделить ClientHello на отдельные записи по указанному смещению. Можно указывать несколько раз. |
| `--dpi-desync-split-pos=N|-N|marker+N|marker-N` | (Частично покрывается `-s`, `-d`, `-o`, `-q`, `-f` с указанием смещения `n`) | `zapret`: список через запятую маркеров для tcp сегментации. `buydpi`: ключи для разбиения/OOB/fake используют смещение `n`, которое может быть дополнено флагами `+s` (SNI) или `+h` (Host). |
| **Манипуляции с Поддельными Пакетами (для Десинхронизации)** | | |
| `--dpi-desync-fake-http=<filename>\|0xHEX` | `-l, --fake-data <file\|:str>` | `zapret`: файл, содержащий фейковый http запрос для dpi-desync=fake. `buydpi`: Указать свои поддельные пакеты. |
| `--dpi-desync-fake-tls=<filename>\|0xHEX\|!` | `-l, --fake-data <file\|:str>` | `zapret`: файл, содержащий фейковый tls clienthello для dpi-desync=fake. `buydpi`: Указать свои поддельные пакеты. |
| | `-n, --tls-sni <str>` | `buydpi`: Изменить SNI в fake пакете на указанный. |
| `--dpi-desync-fooling=<fooling>` (где fooling: none md5sig badseq badsum datanoack hopbyhop hopbyhop2) | `-k, --ip-opt[=file\|:str]`, `-S, --md5sig` | `zapret`: дополнительные методики как сделать, чтобы фейковый пакет не дошел до сервера. `buydpi`: `-k`: Установить опции для фейкового IP пакета. `-S`: Установить опцию TCP MD5 Signature для фейкового пакета. |
| | `-O, --fake-offset <n>` | `buydpi`: Сместить начало фейковых данных на n байт. |
| | `-e, --oob-data <char>` | `buydpi`: Байт, отсылаемый вне основного потока, по умолчанию 'a'. (Используется с OOB техниками) |
| | `-a, --udp-fake <count>` | `buydpi`: Количество фейковых UDP пакетов. |
| **Фильтрация (Хосты, IP, Порты, Протоколы)** | | |
| `--hostlist=<filename>` | `-H, --hosts <file\|:string>` | `zapret`: действовать только над доменами, входящими в список из filename. `buydpi`: Ограничить область действия параметров списком доменов. Домены должны быть разделены новой строкой или пробелом. |
| `--hostlist-domains=<domain_list>` | `-H, --hosts <:string>` (подразумевается) | `zapret`: фиксированный список доменов через зяпятую. `buydpi`: `-H` поддерживает строку с доменами. |
| `--hostlist-exclude=<filename>` / `--hostlist-exclude-domains=<domain_list>` | | `zapret`: не применять дурение к доменам из листа. |
| `--filter-l3=ipv4\|ipv6` | (Частично `-I, --conn-ip <ip>`) | `zapret`: фильтр версии ip для текущей стратегии. `buydpi` (`-I`): При указании IPv4 адреса [для исходящих соединений] запросы на IPv6 будут отклоняться. |
| `--filter-tcp=[~]port1[-port2]\|*` / `--filter-udp=[~]port1[-port2]\|*` | `-V, --pf <port[-portr]>` | `zapret`: фильтр портов tcp/udp для текущей стратегии. `buydpi`: Ограничитель по портам. |
| `--filter-l7=<proto>` (http, tls, quic, wireguard, dht, discord, stun, unknown) | `-K, --proto <t,h,u>` | `zapret`: фильтр протокола L6-L7. `buydpi`: Белый список протоколов: tls,http,udp. |
| `--ipset=<filename>` / `--ipset-ip=<ip_list>` / `--ipset-exclude=<filename>` / `--ipset-exclude-ip=<ip_list>` | | `zapret`: включающий/исключающий ip list / фиксированный список подсетей. |
| **Автоматический Режим / Обнаружение Блокировок** | | |
| `--hostlist-auto=<filename>` | `-A, --auto <t,r,s,n>` | `zapret`: обнаруживать автоматически блокировки и заполнять автоматический hostlist. `buydpi`: Автоматический режим. Если произошло событие, похожее на блокировку или поломку, то будут применены параметры обхода, следующие за данной опцией. Возможные события: torst (таймаут/сброс после первого запроса), redirect (HTTP Redirect с несовпадающим доменом), ssl_err (нет ServerHello / некорректный session_id), none (предыдущая группа пропущена). |
| `--hostlist-auto-fail-threshold=<int>` / `--hostlist-auto-fail-time=<int>` | | `zapret`: параметры для автоматического добавления хоста в лист при обнаружении блокировок. |
| **Другие Специфичные Опции** | | |
| `--wsize`, `--wssize`, `--wssize-cutoff` | | `zapret`: различные опции для изменения TCP Window Size (частично устарели). |
| `--synack-split=[syn\|synack\|acksyn]` | | `zapret`: выполнить tcp split handshake. |
| `--dup=<int>`, `--dup-replace=[0\|1]`, `--dup-ttl=<int>`, `--dup-fooling=<fooling>` и связанные | | `zapret`: семейство опций для отправки дубликатов пакетов. |
| | `-N, --no-domain` | `buydpi`: Отбрасывать запросы, если в качестве адреса указан домен. Т.к. резолвинг выполняется синхронно, то он может замедлить или даже заморозить работу. |
| | `-U, --no-udp` | `buydpi`: Не проксировать UDP. |
| | `-T, --timeout <sec>` | `buydpi`: Таймаут ожидания первого ответа от сервера в секундах. В Linux переводится в миллисекунды, поэтому можно указать дробное число. |
| | `-Y, --drop-sack` | `buydpi`: Игнорировать SACK, вынуждая ядро переотправить уже доставленные пакеты. |
