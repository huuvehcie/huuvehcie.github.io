# –†–µ—à–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ VirtualBox –Ω–∞ Arch Linux: Kernel driver not installed

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã](#–æ–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º—ã)
- [üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤](#–ø—Ä–æ–≤–µ—Ä–∫–∞-—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö-–ø–∞–∫–µ—Ç–æ–≤)
- [üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞/–ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞–ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–ø–∞–∫–µ—Ç–æ–≤)
- [‚öôÔ∏è –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –º–æ–¥—É–ª–µ–π DKMS](#–ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞-–º–æ–¥—É–ª–µ–π-dkms)
- [üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞](#–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è-–ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞)
- [‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ DKMS](#–ø—Ä–æ–≤–µ—Ä–∫–∞-—Å—Ç–∞—Ç—É—Å–∞-dkms)
- [üöÄ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π —è–¥—Ä–∞](#–∑–∞–≥—Ä—É–∑–∫–∞-–º–æ–¥—É–ª–µ–π-—è–¥—Ä–∞)
- [‚ö° –ó–∞–ø—É—Å–∫ vboxconfig](#–∑–∞–ø—É—Å–∫-vboxconfig)
- [üë• –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø—Ä–∞–≤-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- [üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ](#–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ-—Ä–µ—à–µ–Ω–∏–µ)
- [üîê –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å Secure Boot](#—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º-—Å-secure-boot)
- [üìù –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏](#—Ñ–∏–Ω–∞–ª—å–Ω—ã–µ-–ø—Ä–æ–≤–µ—Ä–∫–∏)
- [‚ùå –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è](#–µ—Å–ª–∏-–ø—Ä–æ–±–ª–µ–º–∞-—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è)

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–û—à–∏–±–∫–∞ `Kernel driver not installed (rc=-1908)` –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –∫–æ–≥–¥–∞ –º–æ–¥—É–ª–∏ —è–¥—Ä–∞ VirtualBox –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

<a id="–ø—Ä–æ–≤–µ—Ä–∫–∞-—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö-–ø–∞–∫–µ—Ç–æ–≤"></a>
## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

```bash
# –ü—Ä–æ–≤–µ—Ä–∏–º —Ç–µ–∫—É—â–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–∞–∫–µ—Ç—ã VirtualBox
pacman -Q | grep virtualbox

# –ü—Ä–æ–≤–µ—Ä–∏–º —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é —è–¥—Ä–∞
uname -r
```

<a id="—É—Å—Ç–∞–Ω–æ–≤–∫–∞–ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–ø–∞–∫–µ—Ç–æ–≤"></a>
## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞/–ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤

```bash
# –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º—É
sudo pacman -Syu

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–ª–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º VirtualBox –∏ DKMS
sudo pacman -S --force virtualbox virtualbox-host-dkms

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–∫–∏ —è–¥—Ä–∞
sudo pacman -S linux-headers
```

<a id="–ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞-–º–æ–¥—É–ª–µ–π-dkms"></a>
## ‚öôÔ∏è –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –º–æ–¥—É–ª–µ–π DKMS

```bash
# –ü–æ–ª—É—á–∞–µ–º –≤–µ—Ä—Å–∏—é virtualbox-host-dkms
VBOX_VERSION=$(pacman -Q virtualbox-host-dkms | awk '{print $2}' | sed 's/-[^-]*$//')
KERNEL_VERSION=$(uname -r)

echo "–í–µ—Ä—Å–∏—è VirtualBox: $VBOX_VERSION"
echo "–í–µ—Ä—Å–∏—è —è–¥—Ä–∞: $KERNEL_VERSION"

# –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ –º–æ–¥—É–ª–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
sudo dkms remove vboxhost --all

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–æ–¥—É–ª–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —è–¥—Ä–∞
sudo dkms install vboxhost/$VBOX_VERSION -k $KERNEL_VERSION
```

<a id="–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è-–ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞"></a>
## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞

–ï—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Å–ø–æ—Å–æ–± –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª:

```bash
# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π DKMS
sudo dkms autoinstall -k $(uname -r)

# –ò–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –¥–ª—è VirtualBox
sudo dkms build vboxhost/$VBOX_VERSION -k $KERNEL_VERSION
sudo dkms install vboxhost/$VBOX_VERSION -k $KERNEL_VERSION
```

<a id="–ø—Ä–æ–≤–µ—Ä–∫–∞-—Å—Ç–∞—Ç—É—Å–∞-dkms"></a>
## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ DKMS

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
dkms status

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
ls /lib/modules/$(uname -r)/extra/ | grep vbox
```

<a id="–∑–∞–≥—Ä—É–∑–∫–∞-–º–æ–¥—É–ª–µ–π-—è–¥—Ä–∞"></a>
## üöÄ –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π —è–¥—Ä–∞

```bash
# –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥—É–ª–∏ –≤—Ä—É—á–Ω—É—é
sudo modprobe vboxdrv
sudo modprobe vboxnetadp
sudo modprobe vboxnetflt
sudo modprobe vboxpci

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –º–æ–¥—É–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã
lsmod | grep vbox
```

<a id="–∑–∞–ø—É—Å–∫-vboxconfig"></a>
## ‚ö° –ó–∞–ø—É—Å–∫ vboxconfig

```bash
# –í—ã–ø–æ–ª–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫—É VirtualBox
sudo /sbin/vboxconfig
```

<a id="–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø—Ä–∞–≤-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"></a>
## üë• –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
# –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É vboxusers
sudo usermod -aG vboxusers $USER

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á–ª–µ–Ω—Å—Ç–≤–æ –≤ –≥—Ä—É–ø–ø–µ
groups $USER
```

<a id="–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ-—Ä–µ—à–µ–Ω–∏–µ"></a>
## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ virtualbox-host-modules-arch

```bash
# –£–¥–∞–ª—è–µ–º DKMS –≤–µ—Ä—Å–∏—é
sudo pacman -Rns virtualbox-host-dkms

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–æ–¥—É–ª–∏, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è Arch
sudo pacman -S virtualbox virtualbox-host-modules-arch

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –º–æ–¥—É–ª–∏
ls /lib/modules/$(uname -r)/extramodules/ | grep vbox
```

<a id="—Ä–µ—à–µ–Ω–∏–µ-–ø—Ä–æ–±–ª–µ–º-—Å-secure-boot"></a>
## üîê –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å Secure Boot

### –ï—Å–ª–∏ —É –≤–∞—Å –≤–∫–ª—é—á–µ–Ω Secure Boot:

#### –í–∞—Ä–∏–∞–Ω—Ç A: –û—Ç–∫–ª—é—á–∏—Ç—å Secure Boot
1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–º–ø—å—é—Ç–µ—Ä
2. –ó–∞–π–¥–∏—Ç–µ –≤ BIOS/UEFI –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
3. –ù–∞–π–¥–∏—Ç–µ –æ–ø—Ü–∏—é Secure Boot –∏ –æ—Ç–∫–ª—é—á–∏—Ç–µ –µ—ë
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ—Å—å

#### –í–∞—Ä–∏–∞–Ω—Ç B: –ü–æ–¥–ø–∏—Å–∞—Ç—å –º–æ–¥—É–ª–∏ (–µ—Å–ª–∏ Secure Boot –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è –≤–∫–ª—é—á–µ–Ω–Ω—ã–º)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
sudo pacman -S mokutil openssl

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏ –¥–ª—è –∫–ª—é—á–µ–π
sudo mkdir -p /var/lib/shim-signed/mok/

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π
sudo openssl req -new -x509 -newkey rsa:2048 \
  -keyout /var/lib/shim-signed/mok/MOK.priv \
  -outform DER -out /var/lib/shim-signed/mok/MOK.der \
  -nodes -days 36500 -subj "/CN=VirtualBox/"

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∫–ª—é—á–∞
sudo mokutil --import /var/lib/shim-signed/mok/MOK.der

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –º–æ–¥—É–ª–µ–π
sudo tee /etc/modprobe.d/vbox.conf << EOF
signer="/var/lib/shim-signed/mok/MOK.der"
key="/var/lib/shim-signed/mok/MOK.priv"
EOF
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ:
1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É
2. –í–æ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è —Å–∏–Ω–∏–π —ç–∫—Ä–∞–Ω MOK Management
3. –í—ã–±–µ—Ä–∏—Ç–µ "Enroll MOK" ‚Üí "Continue" ‚Üí "Yes"
4. –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å (–µ—Å–ª–∏ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è)
5. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ—Å—å

<a id="—Ñ–∏–Ω–∞–ª—å–Ω—ã–µ-–ø—Ä–æ–≤–µ—Ä–∫–∏"></a>
## üìù –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å–∏—Å—Ç–µ–º—É
sudo reboot

# –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º:
systemctl status vboxservice
lsmod | grep vbox
VBoxManage --version
```

<a id="–µ—Å–ª–∏-–ø—Ä–æ–±–ª–µ–º–∞-—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è"></a>
## ‚ùå –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∂—É—Ä–Ω–∞–ª—ã:**
```bash
sudo dmesg | grep vbox
journalctl -u vboxservice
```

2. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —è–¥—Ä–æ:**
```bash
sudo pacman -S linux-lts linux-lts-headers
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ—Å—å –≤ LTS —è–¥—Ä–æ –∏ –ø–æ–≤—Ç–æ—Ä–∏—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∫—É
```

3. **–ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
sudo pacman -Rns virtualbox virtualbox-host-dkms
sudo rm -rf /etc/vbox /usr/lib/virtualbox
sudo pacman -S virtualbox virtualbox-host-modules-arch virtualbox-guest-iso
```

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö —à–∞–≥–æ–≤ VirtualBox –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
